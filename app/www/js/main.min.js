"use strict";var yellr=yellr||{};yellr.width=undefined;yellr.height=undefined;yellr.language=1;yellr.notificationNode=undefined;yellr.questionNode=undefined;yellr.questionClose=undefined;yellr.main={init:function(){$("#add-more-media-btn").on("click",function(g){g.preventDefault();if($("#media-input-wrapper input").length>=5){alert("Only 5 media files can be uploaded at this time");return}else{var d=document.createElement("input");d.setAttribute("type","file");$("#media-input-wrapper").append(d)}});$("#save-draft").on("click",function(d){d.preventDefault();alert("This requires an account? Maybe we can use localStorage... Added to drafts")});yellr.setUp.DOMreferences();var b=window,h=document,f=h.documentElement,c=h.getElementsByTagName("body")[0],a=b.innerWidth||f.clientWidth||c.clientWidth,i=b.innerHeight||f.clientHeight||c.clientHeight;yellr.width=a;yellr.height=i;$.ajax({url:"/data/question.json",beforeSend:function(d){d.overrideMimeType("text/plain; charset=x-user-defined")}}).done(function(e){var d=$.parseJSON(e);if(d.question_available){yellr.main.askQuestion(d)}else{console.log("no new question")}})},askQuestion:function(b){yellr.notificationNode.className="new-question";yellr.notificationNode.firstChild.innerHTML="!";yellr.notificationNode.title="New question available!";var k=yellr.language==1?b.question_texts[0].question_text:b.question_texts[1].question_text;document.querySelector("#notification-msg p").innerHTML=k;var h=document.querySelector("#question-answers");for(var c=0;c<b.answer_values.length;c++){var j=document.createElement("li");var e=document.createElement("label");var f=document.createElement("input");f.setAttribute("type","radio");f.setAttribute("name","answer");f.setAttribute("value",b.answer_values[c].answer_value);var g=document.createElement("span");g.innerHTML=b.answer_values[c].answer_text;e.appendChild(f);e.appendChild(g);j.appendChild(e);h.appendChild(j)}var a=document.querySelector("#extra-fields");for(var c=0;c<b.allowed_media.length;c++){var d=b.allowed_media[c];var j=document.createElement("li");var e=document.createElement("label");var g=document.createElement("span");var f;if(d=="text"){f=document.createElement("textarea")}else{f=document.createElement("input");f.setAttribute("type","file");f.setAttribute("name","media_payload")}g.innerHTML=yellr.utils.capitalize(d);e.appendChild(g);e.appendChild(f);j.appendChild(e);a.appendChild(j)}document.querySelector("#more-details").onclick=function(){if(this.innerHTML=="Back"){this.innerHTML="Add more details";document.querySelector("#question-answers").className="current";document.querySelector("#extra-fields").className=""}else{this.innerHTML="Back";document.querySelector("#question-answers").className="";document.querySelector("#extra-fields").className="current"}};h.className="current"}};yellr.setUp={DOMreferences:function(){yellr.questionNode=document.querySelector("#notification-msg");yellr.questionClose=document.querySelector("#msg-close");yellr.questionClose.onclick=function(a){a.preventDefault();yellr.questionNode.className=yellr.questionNode.className?"":"show"};yellr.notificationNode=document.querySelector("#notification-li");yellr.notificationNode.firstChild.onclick=function(a){a.preventDefault();yellr.questionNode.className=yellr.questionNode.className?"":"show"}},homepage:function(){document.querySelector("#secondary-bar li").className="current";document.querySelector("#main-feed-wrapper ul").className="current";var b=document.querySelectorAll("#secondary-bar a");for(var a=0;a<b.length;a++){var c=b[a];c.onclick=function(d){d.preventDefault();document.querySelector("#secondary-bar .current").className="";this.parentNode.className="current";document.querySelector("#main-feed-wrapper ul.current").className="";if(this.innerHTML.toLowerCase()=="assignments"){document.querySelector("#latest-assignments").className="current"}else{document.querySelector("#latest-stories").className="current"}}}}};yellr.utils={placeOffscreen:function(b){var a=yellr.height;b.setAttribute("style","height: "+a+"px; -webkit-transform: translateY(-"+a+"px); -ms-transform: translateY(-"+a+"px); -o-transform: translateY(-"+a+"px); transform: translateY(-"+a+"px)")},capitalize:function(a){return a.charAt(0).toUpperCase()+a.slice(1)}};window.onload=function(){yellr.main.init()};